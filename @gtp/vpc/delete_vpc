#!/usr/bin/env bash

set -euo pipefail

if [ "$#" -ne 4 ]; then
    echo "Usage: $0 <vpc-id> <igw-id> <subnet-id> <route-table-id>"
    exit 1
fi

VPC_ID="$1"
IGW_ID="$2"
SUBNET_ID="$3"
RTB_ID="$4"

echo "Detaching IGW: $IGW_ID from VPC: $VPC_ID"
aws ec2 detach-internet-gateway \
  --internet-gateway-id "$IGW_ID" \
  --vpc-id "$VPC_ID"

echo "Deleting IGW: $IGW_ID"
aws ec2 delete-internet-gateway \
  --internet-gateway-id "$IGW_ID"

echo "Deleting Subnet: $SUBNET_ID"
aws ec2 delete-subnet \
  --subnet-id "$SUBNET_ID"

echo "Deleting Route Table: $RTB_ID"
aws ec2 delete-route-table \
  --route-table-id "$RTB_ID"

echo "Deleting VPC: $VPC_ID"
aws ec2 delete-vpc \
  --vpc-id "$VPC_ID"

echo "âœ… Teardown complete."